---
import { FAQS } from "../../config/faqs.ts";
---

<script>
  // Smooth open/close animation for FAQ answers
  document.addEventListener("DOMContentLoaded", () => {
    const detailsList = document.querySelectorAll(".faq-list details");
    detailsList.forEach((details) => {
      const summary = details.querySelector("summary");
      const content = summary.nextElementSibling;
      if (!content) return;

      content.style.overflow = "hidden";
      content.style.transition = "max-height 0.45s cubic-bezier(0.4,0,0.2,1)";
      content.style.maxHeight = details.open
        ? content.scrollHeight + "px"
        : "0px";

      details.addEventListener("click", (e) => {
        e.preventDefault();
        if (details.open) {
          // Close with animation
          content.style.maxHeight = content.scrollHeight + "px";
          requestAnimationFrame(() => {
            content.style.maxHeight = "0px";
          });
          content.addEventListener("transitionend", function handler() {
            details.open = false;
            content.removeEventListener("transitionend", handler);
          });
        } else {
          // Open with animation
          details.open = true;
          content.style.maxHeight = "0px";
          requestAnimationFrame(() => {
            content.style.maxHeight = content.scrollHeight + "px";
          });
          content.addEventListener("transitionend", function handler() {
            content.style.maxHeight = "";
            content.removeEventListener("transitionend", handler);
          });
        }
      });

      // On resize, update maxHeight if open
      window.addEventListener("resize", () => {
        if (details.open) {
          content.style.maxHeight = content.scrollHeight + "px";
          setTimeout(() => {
            content.style.maxHeight = "";
          }, 450);
        }
      });
    });
  });
</script>

<section id="faq">
  <h2 class="faq-title">Domande frequenti</h2>
  <div class="faq-list">
    {
      FAQS.map(({ question, answer }) => (
        <details>
          <summary>{question}</summary>
          <div>
            <div class="separator" />
            {answer}
          </div>
        </details>
      ))
    }
  </div>
</section>

<style>
  #faq {
    width: 100%;
    padding: 4rem 2rem;
    background: var(--color-bg-soft, #f5f7f6);
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  .faq-title {
    font-size: 2rem;
    color: var(--color-primary-dark, #6f8f7c);
    margin-bottom: 2rem;
    text-align: center;
  }
  .faq-list {
    width: 100%;
    max-width: 700px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1.2rem;
  }
  .faq-list details {
    background: #fff;
    width: 100%;
    border-radius: 0.7rem;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.04);
    transition: box-shadow 0.2s;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    align-items: start;
    padding: 1rem 2rem;
    cursor: pointer;
  }
  .faq-list details[open] {
    box-shadow: 0 4px 18px rgba(0, 0, 0, 0.08);
  }
  .faq-list summary {
    font-size: 1.15rem;
    font-weight: 600;
    color: var(--color-primary, #94b09f);
    outline: none;
    user-select: none;
  }
  .faq-list p {
    color: var(--color-text-main, #222);
    font-size: 1.05rem;
    margin: 0;
  }
  .separator {
    height: 1rem;
  }
  @media (max-width: 600px) {
    #faq {
      padding: 2rem 0.7rem;
    }
    .faq-list details {
      padding: 1rem 1rem;
    }
    .faq-list summary {
      font-size: 1rem;
      padding: 0.5rem 0.5rem;
    }
    .faq-list p {
      font-size: 0.98rem;
    }
  }
</style>
